<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Sunset Hoops – Scores, Classements, Équipes & Joueurs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root{
      --bg:#0f0d14;
      --panel:#1a1720;

      /* Couleurs Phoenix Suns (sources officielles) */
      --sun-purple:#1D1160;   /* Purple [1](https://rapidapi.com/Creativesdev/api/nba-api-free-data) */
      --sun-orange:#E56020;   /* Orange [1](https://rapidapi.com/Creativesdev/api/nba-api-free-data) */
      --sun-yellow:#F9A01B;   /* Yellow [2](http://nbasense.com/nba-api/) */
      --sun-dark-orange:#B95915; /* Dark orange [2](http://nbasense.com/nba-api/) */
      --sun-gray:#63727A;     /* Gray [2](http://nbasense.com/nba-api/) */
      --sun-light-gray:#BEC0C2; /* Light gray [2](http://nbasense.com/nba-api/) */
      --text:#f8f6fa;
      --muted:#dcd5e0;

      /* UI */
      --accent:var(--sun-orange);
      --accent-2:var(--sun-purple);
      --win:#2a9d8f;
      --lose:#e63946;
    }

    *{box-sizing:border-box;margin:0;padding:0;}

    body{
      background:var(--bg);
      color:var(--text);
      font-family:system-ui,sans-serif;
      line-height:1.5;
      padding:14px;
    }

    /***************
      HEADER
    ***************/
    .sunset-header {
      padding: 16px 0 20px 0;
      display:flex;
      flex-direction:column;
      gap:14px;
      border-bottom:1px solid #2b2533;
    }

    .header-left{
      display:flex;
      align-items:center;
      gap:14px;
    }

    .logo{
      width:64px;
      height:64px;
    }

    .title-block h1{
      font-size:1.7rem;
      font-weight:900;
      background:linear-gradient(90deg,var(--sun-orange),var(--sun-yellow));
      -webkit-background-clip:text;
      color:transparent;
    }

    .title-block .sub{
      font-size:0.9rem;
      color:var(--muted);
      margin-top:-2px;
    }

    nav{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
    }

    .tab{
      background:var(--panel);
      border:1px solid #352b45;
      padding:8px 12px;
      border-radius:8px;
      cursor:pointer;
      color:var(--muted);
      font-size:0.9rem;
    }

    .tab.active{
      background:var(--sun-orange);
      border-color:var(--sun-orange);
      color:#2b1405;
    }

    /***************
       PANELS
    ***************/
    main{
      margin-top:18px;
    }

    .panel{
      background:var(--panel);
      border:1px solid #352b45;
      padding:16px;
      border-radius:12px;
      margin-bottom:20px;
    }

    .controls{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
      margin-bottom:12px;
    }

    input, select{
      background:#16131c;
      border:1px solid #352b45;
      color:var(--text);
      padding:8px;
      border-radius:8px;
    }

    button{
      background:var(--sun-orange);
      color:#2b1405;
      border:none;
      padding:8px 14px;
      border-radius:8px;
      font-weight:700;
      cursor:pointer;
    }

    .row{
      display:flex;
      justify-content:space-between;
      padding:10px 0;
      border-bottom:1px solid #352b45;
    }
    .row:last-child{border-bottom:none;}

    .badge{
      padding:2px 8px;
      background:#261f29;
      border-radius:8px;
      font-size:0.75rem;
      color:var(--muted);
    }

    .score{font-weight:800;}

    .table{
      width:100%;
      border-collapse:collapse;
      margin-top:10px;
    }

    .table th,.table td{
      padding:10px 5px;
      border-bottom:1px solid #352b45;
    }

    .right{text-align:right;}

    .teams-grid{
      display:grid;
      grid-template-columns:repeat(auto-fill,minmax(150px,1fr));
      gap:10px;
    }

    .team-card{
      background:#16131c;
      border:1px solid #352b45;
      border-radius:10px;
      padding:10px;
    }

    .muted{color:var(--muted);}

    @media (min-width:768px){
      body{padding:24px;}
      .title-block h1{font-size:2rem;}
      .teams-grid{
        grid-template-columns:repeat(auto-fill,minmax(200px,1fr));
      }
    }
  </style>

</head>

<body>

  <!-- HEADER -->
  <header class="sunset-header">
    <div class="header-left">
      <img src="logo.png" class="logo" alt="Logo Sunset Hoops" />
      <div class="title-block">
        <h1>Sunset Hoops</h1>
        <p class="sub">Scores, Classements, Équipes & Joueurs</p>
      </div>
    </div>

    <nav>
      <button class="tab active" data-tab="scores">Scores du jour</button>
      <button class="tab" data-tab="standings">Classements</button>
      <button class="tab" data-tab="teams">Équipes</button>
      <button class="tab" data-tab="players">Joueurs</button>
    </nav>
  </header>


  <!-- PANELS -->
  <main>

    <!-- SCORES -->
    <section id="scores" class="panel">
      <div class="controls">
        <label>Date : <input type="date" id="score-date"/></label>
        <button id="btn-load-scores">Charger</button>
        <span class="status" id="scores-status"></span>
      </div>
      <div id="scores-list"></div>
    </section>

    <!-- STANDINGS -->
    <section id="standings" class="panel" style="display:none">
      <div class="controls">
        <label>Saison :
          <select id="season-select"></select>
        </label>
        <button id="btn-load-standings">Recalculer</button>
        <span class="status" id="standings-status"></span>
      </div>

      <div style="display:grid;gap:16px;">
        <div>
          <h3>Conférence Est</h3>
          <table class="table" id="east-table">
            <thead><tr><th>#</th><th>Équipe</th><th class="right">V</th><th class="right">D</th><th class="right">%</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
        <div>
          <h3>Conférence Ouest</h3>
          <table class="table" id="west-table">
            <thead><tr><th>#</th><th>Équipe</th><th class="right">V</th><th class="right">D</th><th class="right">%</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- TEAMS -->
    <section id="teams" class="panel" style="display:none">
      <div class="controls">
        <button id="btn-load-teams">Charger les équipes</button>
        <span class="status" id="teams-status"></span>
      </div>
      <div class="teams-grid" id="teams-grid"></div>
    </section>

    <!-- PLAYERS -->
    <section id="players" class="panel" style="display:none">
      <div class="controls">
        <input type="text" id="player-q" placeholder="Rechercher un joueur…" />
        <button id="btn-search-players">Rechercher</button>
        <span class="status" id="players-status"></span>
      </div>
      <div id="players-list"></div>
    </section>

  </main>


  <!-- JAVASCRIPT -->
  <script>
    const API_BASE = "https://api.balldontlie.io/v1";
    const API_KEY = "";
    const FETCH_OPTS = {
      method: "GET",
      mode: "cors",
      cache: "no-store",
      headers: {
        ...(API_KEY ? { "Authorization": API_KEY } : {}),
        "Accept": "application/json"
      }
    };

    const $ = (s)=>document.querySelector(s);
    const $$ = (s)=>Array.from(document.querySelectorAll(s));

    function todayISO(){ return new Date().toISOString().slice(0,10); }
    $("#score-date").value = todayISO();

    async function getJson(url){
      const res = await fetch(url, FETCH_OPTS);
      if(!res.ok) throw new Error("API "+res.status);
      return res.json();
    }

    function toISODate(input){
      const d = new Date(input);
      if(!isNaN(d)) return d.toISOString().slice(0,10);
      return todayISO();
    }

    /***************
      TABS
    ***************/
    $$(".tab").forEach(btn=>{
      btn.addEventListener("click", ()=>{
        $$(".tab").forEach(b=>b.classList.remove("active"));
        btn.classList.add("active");
        ["scores","standings","teams","players"].forEach(id=>{
          $("#"+id).style.display = (btn.dataset.tab===id)?"":"none";
        });
      });
    });

    /***************
      LOAD SCORES
    ***************/
    async function loadScores(){
      const date = toISODate($("#score-date").value);
      const list = $("#scores-list");
      const status = $("#scores-status");
      list.innerHTML = "";
      status.textContent = "Chargement…";

      try{
        const json = await getJson(`${API_BASE}/games?dates[]=${date}`);
        const games = json.data;

        if(!games.length){
          list.innerHTML = "<div>Aucun match ce jour.</div>";
          status.textContent = "";
          return;
        }

        list.innerHTML = games.map(g=>`
          <div class="row">
            <div>
              <div><span class="badge">${g.season}</span></div>
              <div class="muted">${g.visitor_team.full_name} @ ${g.home_team.full_name}</div>
            </div>
            <div class="score">
              ${g.visitor_team.abbreviation} ${g.visitor_team_score} –
              ${g.home_team.abbreviation} ${g.home_team_score}
            </div>
          </div>
        `).join("");

      }catch(e){
        list.innerHTML = `<div>Erreur : ${e.message}</div>`;
      }finally{
        status.textContent = "";
      }
    }
    $("#btn-load-scores").addEventListener("click", loadScores);
    loadScores();

    /***************
      STANDINGS
    ***************/
    const seasonSelect = $("#season-select");
    (function initSeasons(){
      const y = new Date().getFullYear();
      const years = [y, y-1, y-2, y-3];
      seasonSelect.innerHTML = years.map(yy=>`<option value="${yy}">${yy}</option>`).join("");
    })();

    async function loadStandings(){
      const season = seasonSelect.value;
      const status = $("#standings-status");
      status.textContent = "Chargement…";

      const eastBody = $("#east-table tbody");
      const westBody = $("#west-table tbody");
      eastBody.innerHTML = westBody.innerHTML = "";

      try{
        const teams = (await getJson(`${API_BASE}/teams`)).data;
        const byId = Object.fromEntries(teams.map(t=>[t.id,{team:t,w:0,l:0}]));

        async function getAllPages(url){
          let page=1,out=[],total=1;
          do{
            const data=await getJson(url+`&per_page=100&page=${page}`);
            out=out.concat(data.data);
            total=data.meta.total_pages;
            page++;
          }while(page<=total);
          return out;
        }

        const games = await getAllPages(`${API_BASE}/games?seasons[]=${season}&postseason=false`);

        for(const g of games){
          const h=byId[g.home_team.id], a=byId[g.visitor_team.id];
          if(typeof g.home_team_score==="number"){
            if(g.home_team_score > g.visitor_team_score){h.w++;a.l++;}
            else if(g.home_team_score < g.visitor_team_score){a.w++;h.l++;}
          }
        }

        const east=[], west=[];
        for(const id in byId){
          const o=byId[id], team=o.team;
          const t={team,w:o.w,l:o.l,pct:(o.w+o.l?o.w/(o.w+o.l):0)};
          (team.conference==="East"?east:west).push(t);
        }

        const sortFn=(a,b)=>b.pct-a.pct || b.w-a.w;
        east.sort(sortFn); west.sort(sortFn);

        function render(list,tbody){
          tbody.innerHTML=list.map((r,i)=>`
            <tr>
              <td>${i+1}</td>
              <td>${r.team.full_name}</td>
              <td class="right">${r.w}</td>
              <td class="right">${r.l}</td>
              <td class="right">${r.pct.toFixed(3).slice(1)}</td>
            </tr>`).join("");
        }
        render(east,eastBody);
        render(west,westBody);

      }catch(e){
        eastBody.innerHTML=westBody.innerHTML=`<tr><td colspan="5">Erreur : ${e.message}</td></tr>`;
      }finally{
        status.textContent="";
      }
    }
    $("#btn-load-standings").addEventListener("click", loadStandings);

    /***************
      TEAMS
    ***************/
    async function loadTeams(){
      const grid=$("#teams-grid");
      const status=$("#teams-status");
      grid.innerHTML="";
      status.textContent="Chargement…";

      try{
        const teams=(await getJson(`${API_BASE}/teams`)).data;
        grid.innerHTML=teams.map(t=>`
          <div class="team-card">
            <strong>${t.full_name}</strong><br>
            <span class="muted">${t.city} · ${t.division} · ${t.conference}</span>
          </div>`).join("");
      }catch(e){
        grid.innerHTML=`<div>Erreur : ${e.message}</div>`;
      }finally{
        status.textContent="";
      }
    }
    $("#btn-load-teams").addEventListener("click", loadTeams);

    /***************
      PLAYERS
    ***************/
    async function searchPlayers(){
      const q=$("#player-q").value.trim();
      const list=$("#players-list");
      const status=$("#players-status");
      list.innerHTML="";
      if(!q){list.innerHTML="Saisis un nom";return;}
      status.textContent="Recherche…";

      try{
        const data=await getJson(`${API_BASE}/players?search=${encodeURIComponent(q)}`);
        const players=data.data;
        if(!players.length){list.innerHTML="Aucun résultat";return;}
        list.innerHTML=players.map(p=>`
          <div class="row">
            <div>
              <strong>${p.first_name} ${p.last_name}</strong>
              <div class="muted">${p.team.full_name}</div>
            </div>
            <span class="badge">ID ${p.id}</span>
          </div>`).join("");
      }catch(e){
        list.innerHTML=`Erreur : ${e.message}`;
      }finally{
        status.textContent="";
      }
    }
    $("#btn-search-players").addEventListener("click", searchPlayers);

  </script>

</body>
</html>
